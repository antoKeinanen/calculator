#:import math math
#:import main main
#:import colors colors
<CustButton@Button>:
    font_size: 20
    background_normal: ""
    background_down: ""
    background_color: colors.bgr
    border: (0, 0, 0, 0)
    on_state:
        if self.state == "down": \
        self.background_color = colors.primary;
        else: \
        self.background_color = colors.bgr;

<Normal>:
    id: calculator
    display: entry
    rows: 9
    padding: 2
    spacing: 2


    BoxLayout:
        TextInput:
            id: entry
            font_size: 32
            multiline: False
            on_focus: self.focus = False

    BoxLayout:
        spacing: 2
        CustButton:
            on_state:
                if main.shift: \
                self.text = "test";
                else: \
                self.text = "nan";
            text: "shift"
            on_press: main.shift = not main.shift
        CustButton:
            text: "alpha"
            on_state:
                if main.shift: \
                self.text = "test";
                else: \
                self.text = "nan";
        CustButton:
            text: "del"
            on_press: entry.text = entry.text[:-1]
            on_press: main.calc_str += main.calc_str[:-1]
        CustButton:
            text: "ac"
            on_press: entry.text = ""
            on_press: main.calc_str = ""

    BoxLayout:
        spacing: 2
        CustButton:
            text: "π"
            on_press: entry.text += self.text
            on_press: main.calc_str += str(math.pi)
        CustButton:
            text: "sin"
            on_press: entry.text += self.text + "("
            on_press: main.calc_str += "math.sin("
        CustButton:
            text: "cos"
            on_press: entry.text += self.text + "("
            on_press: main.calc_str += "math.cos("
        CustButton:
            text: "tan"
            on_press: entry.text += self.text + "("
            on_press: main.calc_str += "math.tan("

    BoxLayout:
        spacing: 2
        CustButton:
            text: "("
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text
        CustButton:
            text: ")"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text
        CustButton:
            text: "x²"
            on_press: entry.text += "²"
            on_press: main.calc_str += "** 2"
        CustButton:
            text: "√"
            on_state:
                if self.state == "down" and main.shift: \
                print(self.text);
                elif self.state == "down": \
                entry.text += self.text + "(";
                main.calc_str += "math.sqrt(";

    BoxLayout:
        spacing: 2
        CustButton:
            text: "7"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text
        CustButton:
            text: "8"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text
        CustButton:
            text: "9"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text
        CustButton:
            text: "/"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text

    BoxLayout:
        spacing: 2
        CustButton:
            text: "4"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text
        CustButton:
            text: "5"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text
        CustButton:
            text: "6"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text
        CustButton:
            text: "*"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text

    BoxLayout:
        spacing: 2
        CustButton:
            text: "1"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text
        CustButton:
            text: "2"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text
        CustButton:
            text: "3"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text
        CustButton:
            text: "-"
            on_press: entry.text += self.text
            on_press: main.calc_str += self.text

    BoxLayout:
        spacing: 2
        CustButton:
            text: "AC"
            on_press: entry.text = ""
            on_press: main.calc_str = ""
        CustButton:
            text: "0"
            on_press: entry.text += self.text
        CustButton:
            text: "="
            on_press: calculator.calculate(main.calc_str)
        CustButton:
            text: "+"
            on_press: entry.text += self.text