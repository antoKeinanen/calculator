#:import math math
#:import main main
#:import colors colors
#:import time time
<CustButton@Button>:
    font_size: 20
    background_normal: ""
    background_down: ""
    background_color: colors.bgr
    border: (0, 0, 0, 0)
    on_state:
        if self.state == "down": \
        self.background_color = colors.primary;
        else: \
        self.background_color = colors.bgr;

<Normal>:
    GridLayout
        id: calculator
        display: entry
        rows: 9
        padding: 2
        spacing: 2

        BoxLayout:
            TextInput:
                id: entry
                font_size: 32
                multiline: False
                on_focus: self.focus = False

        BoxLayout:
            spacing: 2
            CustButton:
                text: "shift"
                on_press: main.shift = not main.shift
                on_press: root.manager.current = "shift"
            CustButton:
                text: "alpha"
                on_state:
                    if main.shift: \
                    self.text = "test";
                    else: \
                    self.text = "nan";
            CustButton:
                text: "del"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.calc = main.calc[:-1]
                on_press: main.disp = main.disp[:-1]
            CustButton:
                text: "ac"
                on_press: entry.text = ""
                on_press: main.calc.clear()
                on_press: main.disp.clear()

        BoxLayout:
            spacing: 2
            CustButton:
                text: "π"
                on_press: entry.text += self.text
                on_press: main.calc.append("math.pi")

            CustButton:
                text: "sin"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text + "(")
                on_press: main.calc.append("math.sin(")
            CustButton:
                text: "cos"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text + "(")
                on_press: main.calc.append("math.cos(")
            CustButton:
                text: "tan"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text + "(")
                on_press: main.calc.append("math.tan(")

        BoxLayout:
            spacing: 2
            CustButton:
                text: "("
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: ")"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "x²"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append("²")
                on_press: main.calc.append("** 2")
            CustButton:
                text: "√"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)

        BoxLayout:
            spacing: 2
            CustButton:
                text: "7"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "8"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "9"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "/"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)

        BoxLayout:
            spacing: 2
            CustButton:
                text: "4"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "5"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "6"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "*"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)

        BoxLayout:
            spacing: 2
            CustButton:
                text: "1"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "2"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "3"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "-"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)

        BoxLayout:
            spacing: 2
            CustButton:
                text: "0"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "."
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)
            CustButton:
                text: "="
                on_press: main.Normal.calculate(self, root, main.calc)
            CustButton:
                text: "+"
                on_press: self.parent.parent.parent.ids.entry.text = "".join(map(str, main.disp))
                on_press: main.disp.append(self.text)
                on_press: main.calc.append(self.text)

<shift>:
    GridLayout:
        BoxLayout:
            CustButton:
                text: "SHIFT"
                on_press: root.manager.current = "normal"